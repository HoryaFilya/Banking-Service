# Веб-сервис для банковских операций

## Функциональные требования:
В системе есть пользователи (клиенты), у каждого клиента есть строго один “банковский аккаунт”, в котором изначально лежит какая-то сумма. 
Деньги можно переводить между клиентами. На средства также начисляются проценты.
У пользователя также есть телефон и email. Телефон и или email должен быть минимум один. Также у пользователя должна быть указана дата рождения и ФИО.
В системе нет ролей, только обычные клиенты. Имеется служебный апи (с открытым доступом), через который можно заводить новых пользователей в системе, указав логин, пароль, изначальную сумму, телефон и email (логин, телефон и email не должны быть заняты). 
Баланс счета клиента не может уходит в минус ни при каких обстоятельствах.
Пользователь может добавить/сменить свои номер телефона и/или email, если они еще не заняты другими пользователями.
Пользователь может удалить свои телефон и/или email. При этом нельзя удалить последний.
Остальные данные пользователь не может менять.
Сделать АПИ поиска. Искать можно любого клиента. Должна быть фильтрация и пагинация/сортировка. Фильтры:
Если передана дата рождения, то фильтр записей, где дата рождения больше чем переданный в запросе.
Если передан телефон, то фильтр по 100% сходству.
Если передано ФИО, то фильтр по like форматом ‘{text-from-request-param}%’
Если передан email, то фильтр по 100% сходству. 
Доступ к АПИ должен быть аутентифицирован (кроме служебного апи для создания новых клиентов).
Раз в минуту баланс каждого клиента увеличиваются на 5% но не более 207% от начального депозита.
Например:
Было: 100, стало: 105.
Было: 105, стало:110.25.
Реализовать функционал перевода денег с одного счета на другой. Со счета аутентифицированного пользователя, на счёт другого пользователя. Сделать все необходимые валидации и потокобезопасной.

## Нефункциональные требования:
Добавить OpenAPI/Swagger.
Добавить логирование.
Аутентификация через JWT.
Тесты на покрытие функционала трансфера денег.

## Инструкция по запуску

1. Склонируйте репозиторий: `git clone https://github.com/HoryaFilya/Banking-Service.git`
2. Перейдите в директорию проекта: `cd Banking-Service`
3. Поднимите контейнер с PostgreSQL: `docker-compose up`
4. Запустите приложение через: `BankingServiceApplication.java`

## Технологии

- Java 17
- Spring Boot 3
- Maven
- Liquibase
- SQL и PostgreSQL
- JWT
- AssertJ
- Docker
- Lombok

## Эндпоинты

1. Регистрация пользователя  
   `POST http://localhost:8080/api/v1/registration`
   ```json
   {
       "login": "misha",
       "password": "123qwerty",
       "currentBalance": "200",
       "telephone": "89089001234",
       "email": "misha@mail.ru"
   }

2. Аутентификация пользователя
   `POST http://localhost:8080/api/v1/login`
   ```json
   {
       "login": "misha",
       "password": "123qwerty"
   }

3. Выход из аккаунта
   `POST http://localhost:8080/api/v1/logout`

4. Добавление номера телефона и/или email
   `PUT http://localhost:8080/api/v1/users/{id}`
- {id} - id пользователя
   ```json
   {
       "telephone": "89509001234"
       "email": "username@mail.ru"
   }

5. Изменение номера телефона и/или email
   `PATCH http://localhost:8080/api/v1/users/{id}`
- {id} - id пользователя
   ```json
   {
       "oldTelephone": "89089001234",
       "newTelephone": "89089001235",
       "oldEmail": "misha@mail.ru",
       "newEmail": "noname@mail.ru"
   }

6. Удаление номера телефона и/или email
   `DELETE http://localhost:8080/api/v1/users/{id}`
- {id} - id пользователя
   ```json
   {
       "telephone": "89509001235"
       "email": "noname@mail.ru"
   }

7. Получение всех пользователей
   `GET http://localhost:8080/api/v1/users?birthDate=01-01-2000&telephone=89509001234&firstname=Firstname_1&lastname=Lastname_1&patronymic=Patronymic_1&email=misha@mail.ru&limit=100`
   - {birthDate} - дата рождения пользователя (01-01-2000)
   - {telephone} - телефон пользователя (89509001234)
   - {firstname} - имя пользователя (Firstname_1)
   - {lastname} - фамилия пользователя (Lastname_1)
   - {patronymic} - отчество пользователя (Patronymic_1)
   - {email} - email пользователя (misha@mail.ru)
   - {limit} - количество записей (100)

8. Получение пользователя по id
   `GET http://localhost:8080/api/v1/users/{id}`
   - {id} - id пользователя

9. Перевод денег со счета аутентифицированного пользователя на счет другого пользователя
   `POST http://localhost:8080/api/v1/transfer/{id}?amount=40`
- {id} - id пользователя, которому переводим деньги
- {amount} - сумма перевода

## Swagger UI
- localhost:8080/swagger-ui/index.html
- JWT = eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VySWQiOjR9.t4BkSz4Pv1bs1diIYh-rqLdRAkOukX1eOm1_uXSy2fQ (для id = 4 - через Postman)

## Telegram
- @MishaShaikh
